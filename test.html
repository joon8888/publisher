<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://unpkg.com/lenis@1.3.1/dist/lenis.min.js"></script>
  <!-- GSAP + ScrollTrigger -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>
  <div id="app">
    <div class="seciton section--visual">
      <div class="fold-wrap">
        <div class="inner--3d">
          <div class="fold fold--top">
            <div class="fold__align">
              <div class="fold__conts">
                <div class="fold__conts__item">
                  <div class="track">YOUJOON.YOUJOON.YOUJOON.YOUJOON.YOUJOON.<span class="focus">YOUJOON.</span>YOUJOON.YOUJOON.YOUJOON.YOUJOON.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">CHOI.CHOI.<span class="focus">CHOI.</span>CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">Interactive.Interactive.Interactive.Interactive.<span class="focus">Interactive.</span>Interactive.Interactive.Interactive.Interactive.Interactive.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">Publisher.Publisher.Publisher.Publisher.<span class="focus">Publisher.</span>Publisher.Publisher.Publisher.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="fold fold--center">
            <div class="fold__align">
              <div class="fold__conts">
                <div class="fold__conts__item">
                  <div class="track">YOUJOON.YOUJOON.YOUJOON.YOUJOON.YOUJOON.<span class="focus">YOUJOON.</span>YOUJOON.YOUJOON.YOUJOON.YOUJOON.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">CHOI.CHOI.<span class="focus">CHOI.</span>CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">Interactive.Interactive.Interactive.Interactive.<span class="focus">Interactive.</span>Interactive.Interactive.Interactive.Interactive.Interactive.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">Publisher.Publisher.Publisher.Publisher.<span class="focus">Publisher.</span>Publisher.Publisher.Publisher.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="fold fold--bottom">
            <div class="fold__align">
              <div class="fold__conts">
                <div class="fold__conts__item">
                  <div class="track">YOUJOON.YOUJOON.YOUJOON.YOUJOON.YOUJOON.<span class="focus">YOUJOON.</span>YOUJOON.YOUJOON.YOUJOON.YOUJOON.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">CHOI.CHOI.<span class="focus">CHOI.</span>CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.CHOI.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">Interactive.Interactive.Interactive.Interactive.<span class="focus">Interactive.</span>Interactive.Interactive.Interactive.Interactive.Interactive.</div>
                </div>

                <div class="fold__conts__item">
                  <div class="track">Publisher.Publisher.Publisher.Publisher.<span class="focus">Publisher.</span>Publisher.Publisher.Publisher.</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
// 📌 필수: GSAP + ScrollTrigger 등록
gsap.registerPlugin(ScrollTrigger);

// 📌 Lenis 부드러운 스크롤 초기화
const lenis = new window.Lenis({
  smooth: true,
  lerp: 0.1,
  direction: 'vertical',
  gestureDirection: 'vertical',
  wheelMultiplier: 1,
  touchMultiplier: 1,
  normalizeWheel: true,
})

ScrollTrigger.scrollerProxy(document.body, {
  scrollTop(value) {
    return arguments.length
      ? lenis.scrollTo(value, { immediate: true }) // 수동 설정 시
      : lenis.animatedScroll
  },
  getBoundingClientRect() {
    return {
      top: 0,
      left: 0,
      width: window.innerWidth,
      height: window.innerHeight
    }
  },
  pinType: document.body.style.transform ? 'transform' : 'fixed'
})

ScrollTrigger.scrollerProxy(document.body, {
  scrollTop(value) {
    return arguments.length
      ? lenis.scrollTo(value, { immediate: true }) // 수동 설정 시
      : lenis.animatedScroll
  },
  getBoundingClientRect() {
    return {
      top: 0,
      left: 0,
      width: window.innerWidth,
      height: window.innerHeight
    }
  },
  pinType: document.body.style.transform ? 'transform' : 'fixed'
})


// 📌 Lenis 루프 실행 (requestAnimationFrame)
function raf(time) {
  lenis.raf(time)
  requestAnimationFrame(raf)
}
requestAnimationFrame(raf)

// 📌 Lenis가 스크롤하면 ScrollTrigger 갱신
lenis.on('scroll', ScrollTrigger.update)

gsap.utils.toArray('.fold__conts__item').forEach((el, index) => {
	const w = el.querySelector('.track');
	const [x, xEnd] = (index % 2 == 0) ? [-500, -1500] : [-500, 0];
	gsap.fromTo(w, {  x  }, {
		x: xEnd,
		scrollTrigger: {
      trigger: el,
			scrub: 1,
      scroller: document.body,
		}
	});
});
const centerFold = document.querySelector('.fold--center');
const centerContent = centerFold?.querySelector('.fold--center .fold__conts');
const foldsContent = Array.from(document.querySelectorAll('.fold__conts'));

let targetScroll = -(
  document.documentElement.scrollTop || document.body.scrollTop
);
let currentScroll = targetScroll;

const tick = () => {
  const overflowHeight = centerContent.clientHeight - centerFold.clientHeight;

  document.body.style.height = `${overflowHeight + window.innerHeight}px`;

  targetScroll = -(
    document.documentElement.scrollTop || document.body.scrollTop
  );
  currentScroll += (targetScroll - currentScroll) * 0.1;
  foldsContent.forEach(content => {
    content.style.transform = `translateY(${currentScroll}px)`;
  });
  requestAnimationFrame(tick);
};
tick();

  </script>
</body>
</html>